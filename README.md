# JSOrientationTest

* 一定の比率を維持したコンテンツエリアを作ること。
* スマートフォンで縦横回転をロックできること。
* ユーザーが意図的に縦横指定してロックできること。

これを目指したい。

主に、縦横は `<body data-orientation="portrait|landscape">` で指定する。
今回はデフォルトは横の `landscape` とする。

この指定で縦横固定比率の比率を変更する。

画面ロックはJSで頑張る。

## やってること

### コンテンツブロック

ベースはこれ。

[https://github.com/HirokiMiyaoka/til/blob/master/Language/HTML5/AspectRatioBlock.md](til/アスペクト比を維持したブロック)

これは比率とそれに応じたメディアクエリを使っていい感じにアスペクト比を維持する最小サンプル。

これを改造して以下4パターンをCSSで実装している。

* 横長16:9で画面の横幅いっぱいまで使う（縦に隙間ができる）
* 横長9:16で画面横幅いっぱいまで使う（縦に隙間ができる）
  * なお、これは縦横比の数値をCSSカスタムプロパティで実現しているが、それをひっくり返すことで実現している。
* 画面が16:9より横長で横画面指定の場合、横長16:9で高さいっぱいまで使う（横に隙間ができる）
* 画面が9:16より横長で縦画面指定の場合、縦長9:16で高さいっぱいまで使う（横に隙間ができる）

下2つはメディアクエリを駆使。

ポイントは2つめの比率ひっくり返しかなと。

## 画面固定

https://developer.mozilla.org/ja/docs/Web/API/Screen/orientation

JSはこれでロックできる。

注意点として、縦画面だけど横長とか、横画面だけど縦長みたいなケース諸々があるので、コンテンツと混ざってわけわからなくなる。

そこで今回はコンテンツは完全に `<body>` に縦指定しない限り横にする処理を入れ、コンテンツの縦横は分離。
ロックとかはもうそのままロックするだけに絞ったので結構楽になんとかなってそう。多分。

追記：こいつフルスクリーンでしかだめだったので、PWAにしないと。

## PWA

どうもPWAでは画面ロックできないらしい。（Manifestではできる。）

普通にAPIを呼ぶとManifestで `"display": "fullscreen"` にしてもフルスクリーンではない判定になる。

また、フルスクリーンのAPIも返事が返ってこない（成功も失敗もせず延々と）ので、完全に機能停止している。

要望としてはPWAの時にはどんなモードであれ画面ロックをJSでやりたい。
